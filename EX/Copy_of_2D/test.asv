N=8;
A=delsq(numgrid('S',N+1));

B = delsq(numgrid('S', N/2 + 1));
size(B,1)
[P,R] = get_PR_fw(N/2 - 1); 

size(P);

B;

R*A*P;


full(R);

gg = [1 1 1 1 1 1 1 1 2 2 2 2 2 1 1 2 3 3 3 2 1 1 2 3 4 3 2 1 1 2 3 3 3 2 1 1 2 2 2 2 2 1 1 1 1 1 1 1 1 ].';

gg

R*gg










